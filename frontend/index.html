<!doctype html>
<html>
<head>
  <meta charset="utf-8"/>
  <title>Digital Card — Meeting Scheduler</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <style>
    body{font-family:Arial,Helvetica,sans-serif;max-width:800px;margin:2rem auto;padding:1rem}
    .card{padding:1rem;border:1px solid #ddd;border-radius:8px}
    label{display:block;margin:0.5rem 0}
  </style>
</head>
<body>
  <div class="card">
    <h1 id="name">Loading...</h1>
    <p id="title"></p>
    <p id="email"></p>
    <p id="bio"></p>
  </div>

  <div class="card" style="margin-top:1rem;">
    <h2>Schedule a meeting</h2>
    <form id="meetForm">
      <label>Name <input id="mname" required></label>
      <label>Email <input id="memail" type="email"></label>
      <label>When <input id="mtime" type="datetime-local" required></label>
      <button type="submit">Schedule</button>
    </form>
    <h3>Upcoming meetings</h3>
    <ul id="meetings"></ul>
  </div>

<script>
const API = '/api'; // same host; in OpenShift route will expose frontend and proxy to backend via service
async function loadContact(){
  const r = await fetch(API + '/contact');
  const j = await r.json();
  document.getElementById('name').innerText = j.name;
  document.getElementById('title').innerText = j.title;
  document.getElementById('email').innerText = j.email;
  document.getElementById('bio').innerText = j.bio;
}
async function loadMeetings(){
  const r = await fetch(API + '/meetings');
  const arr = await r.json();
  const el = document.getElementById('meetings');
  el.innerHTML = '';
  arr.forEach(m => {
    const li = document.createElement('li');
    li.innerText = `${m.name} — ${new Date(m.scheduled_at).toLocaleString()}`;
    el.appendChild(li);
  });
}
document.getElementById('meetForm').addEventListener('submit', async e=>{
  e.preventDefault();
  const name = document.getElementById('mname').value;
  const email = document.getElementById('memail').value;
  const scheduled_at = document.getElementById('mtime').value;
  await fetch(API + '/meetings', {
    method:'POST', headers:{'Content-Type':'application/json'},
    body: JSON.stringify({name, email, scheduled_at})
  });
  await loadMeetings();
  e.target.reset();
});
loadContact();
loadMeetings();
</script>
</body>
</html>
